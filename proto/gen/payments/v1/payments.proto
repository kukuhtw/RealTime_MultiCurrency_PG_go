// proto/gen/payments/v1/payments.proto

// proto/gen/payments/v1/payments.proto
syntax = "proto3";

package payments.v1;
option go_package = "github.com/example/payment-gateway-poc/proto/gen/payments/v1;paymentsv1";

import "common/v1/common.proto";

// ====== CreatePayment (opsional: tetap ada bila kamu pakai di tempat lain) ======
message CreatePaymentRequest {
  int64               amount_minor        = 1;
  common.v1.Currency  currency            = 2;
  string              source_account      = 3;
  string              destination_account = 4;
  string              client_tx_id        = 5;
}
message CreatePaymentResponse {
  string payment_id = 1;
  string status     = 2;
}

// ====== LogAndSettle (dipakai worker) ======
message LogAndSettleRequest {
  string idempotency_key = 1;
  string sender_id       = 2;
  string receiver_id     = 3;
  int64  amount_idr      = 4;
  string currency        = 5; // as-submitted
  string tx_date         = 6; // ISO-8601
}

message LogAndSettleResponse {
  string status         = 1; // "SUCCESS", "FAILED", ...
  string message        = 2;
  string reservation_id = 3;
}

service PaymentsService {
  rpc CreatePayment (CreatePaymentRequest) returns (CreatePaymentResponse);
  rpc LogAndSettle (LogAndSettleRequest)   returns (LogAndSettleResponse);
}
